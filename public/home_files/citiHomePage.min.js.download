var signonInitialHeight,signonModalHeight;function populateEFDParams(){var a=new Date();var e=a.getTimezoneOffset();var d=(new Date().getTimezoneOffset()/60)*(-1);var c=$("#efdBTZ");var b=$("#efdCSR");if(c!=null&&b!=null){$("#efdBTZ").val(d);$("#efdCSR").val(screen.width+"x"+screen.height)}}function populateClientData(a){populateEFDParams();if(a.devicePrint){a.devicePrint.value=encode_deviceprint()}}function doSubmit(c){var b;if(!signonLock){var a=new Date();var g=a.getTimezoneOffset();var d=(new Date().getTimezoneOffset()/60)*(-1);$("#efdBTZ").val(d);$("#efdCSR").val(screen.width+"x"+screen.height);if(c){b=c;while(b&&b.nodeName!="FORM"){b=b.parentNode}}else{b=$("#logInForm")[0]}if(window.savingsPagedef=="jcbol_marketing_citi-savings"){$(b).append('<input type="hidden" name="next_page" value="jfp|jcbol_marketing_citi-savings" /><input type="hidden" name="mobileOptimize" value="false" />')}else{if(window.savingsPagedef=="jcbol_marketing_citibank-savings-plus-account"){$(b).append('<input type="hidden" name="next_page" value="jfp|jcbol_marketing_citibank-savings-plus-account" /><input type="hidden" name="mobileOptimize" value="false" />')}else{if(window.CDIRAPagedef=="jcbol_marketing_certificates-of-deposit"){$(b).append('<input type="hidden" name="next_page" value="jfp|jcbol_marketing_certificates-of-deposit" /><input type="hidden" name="mobileOptimize" value="false" />')}else{if(window.IRAPagedef=="jcbol_marketing_citi-ira"){$(b).append('<input type="hidden" name="next_page" value="jfp|jcbol_marketing_citi-ira" /> ')}else{if(window.CDnextPageDef=="jcbol_marketing_cdsDeepdrop"){$(b).append('<input type="hidden" name="product_list" value='+window.CDTermValue+' />	<input type="hidden" name="next_page" value="jfp|jcbol_marketing_cdsDeepdrop" /><input type="hidden" name="mobileOptimize" value="false" />')}}}}}populateClientData(b);if(signOnUnamePwdError(b)){(b.ioBlackBox!=null&&b.ioBlackBox!="undefined")?setIOBlackBox(b):"";clearFieldErrorValidation();jQuery("#logInForm").submit()}else{callbackFunction=function(e){doSubmit(e)};return false}}}function signOnUnamePwdError(b){var c=b.username;var a=true;if((c.value==""&&$("#password").val()=="")||(c.value==""&&$("#password").val()!="")){clearFieldErrorValidation();$("#username,#usernameMasked").addClass("validation-input-danger").focus();$("#emptyUidError").removeClass("hidden").addClass("show");$("#username").attr("aria-describedby","emptyUidError");a=false}else{if((c.value!=""||c.value.length<3)&&$("#password").val()==""){clearFieldErrorValidation();$("#password").addClass("validation-input-danger").focus();$("#emptyPasswordError").removeClass("hidden").addClass("show");$("#password").attr("aria-describedby","emptyPasswordError");a=false}else{if(c.value!=""&&$("#password").val()!=""){if(c.value.length<3){clearFieldErrorValidation();$("#username,#usernameMasked").addClass("validation-input-danger").focus();$("#lessUidChaError").removeClass("hidden").addClass("show");$("#username").attr("aria-describedby","lessUidChaError");a=false}else{if(c.value.length>=3&&$("#password").val().length<6){clearFieldErrorValidation();$("#password").addClass("validation-input-danger").focus();$("#lessPasswordChaError").removeClass("hidden").addClass("show");$("#password").attr("aria-describedby","lessPasswordChaError");a=false}}}}}if($("#lessUidChaError").is(":visible")&&$("#emptyUidError").is(":visible")){jQuery("#username").attr("aria-describedby","emptyUidError lessUidChaError")}if($("#emptyPasswordError").is(":visible")&&$("#lessPasswordChaError").is(":visible")){jQuery("#password").attr("aria-describedby","emptyPasswordError lessPasswordChaError")}adjustHeroHeight($(".signonContainer").height());signonModalHeight=$("#hpSignonModal .modal-dialog").height();return a}function clearFieldErrorValidation(){$("#emptyUidError,#emptyPasswordError,#lessUidChaError,#lessPasswordChaError").addClass("hidden");$("#username").removeClass("validation-input-danger");$("#logInForm #usernameMasked").removeClass("validation-input-danger");$("#password").removeClass("validation-input-danger");return true}function onSelectUser(b){var a="${pb.isMobile}";var f=b[b.selectedIndex].value;if(f=="AddUser"){var e=$("#cookiedList");var d=$("#rememberUid");var c=$("#cookiedListLabel");if(e&&d&&typeof uidInputField!="undefined"){$(uidInputField).insertBefore(e);e.remove();c.remove();$(detachedRemChkBoxDesktop).appendTo("#rememberBlockDesktop");$(detachedRemChkBoxMobile).appendTo("#rememberBlockMobile");$("input[type='checkbox']").prop("checked",false);setTimeout(function(){$("#username").focus()},0)}else{location.href="/JSO/signon/DisplayUsernameSignon.do?username=AddUser"}}else{if(f=="DeleteUser"){if("true"==a){location.href=contextPath+"/JSO/signon/DeleteUsername.do?mobileOptimize=true&JFP_TOKEN="+JFP_CSRF_TOKEN}else{location.href=contextPath+"/JSO/signon/DeleteUsername.do?JFP_TOKEN="+JFP_CSRF_TOKEN}}else{$("#cookiedList").focus()}}doMask();$("#usernameMasked").attr("placeholder",maskedPlaceHolder);$("#usernameMasked").focus()}function insertAfter(a,b){a.parentNode.insertBefore(b,a.nextSibling)}function mask(d){var c=d.value;var a=d.className;if(a.indexOf("userMask")!=-1){var b="";if(c.length>=7){for(i=2;i<c.length-2;i++){b=b+"*"}return c.substring(0,2)+b+c.substring(c.length-2)}else{if(c.length>=3){for(i=1;i<c.length-1;i++){b=b+"*"}return c.substring(0,1)+b+c.substring(c.length-1)}else{return c}}}}function focusOn(b){var a=b.id.substring(0,b.id.length-"Masked".length);var c=document.getElementById(a);b.style.display="none";c.style.display="block";c.focus()}function blurOn(a){var b=a.id+"Masked";var c=document.getElementById(b);$("#"+b).attr("placeholder",maskedPlaceHolder);c.value=mask(a);c.style.display="block";a.style.display="none"}function doMask(){var c=$("input[type='text']");var b=c.length;for(i=0;i<b;i++){var e=c[i];var a=e.className;var f=e.id;if(f.indexOf("Masked")!=-1){b=b+1}else{if(a.indexOf("Mask")!=-1){c[i].onblur=function(g){that=this;blurOn(that)};window["id"+i]=document.createElement("input");window["id"+i].id=e.id+"Masked";window["id"+i].className=" "+e.className+"";var d=document.getElementById(e.id);d.style.display="none";window["id"+i].onfocus=function(g){that=this;focusOn(that)};window["id"+i].type="text";window["id"+i].value=mask(e);insertAfter(e,window["id"+i])}}}}function OpenInNewTab(a){var b=window.open(a,"_blank");b.focus()}function displayLable(b){var a=b+"Label";($("#"+b).val()!="")?$("#"+a).removeClass("text-input-label"):$("#"+a).addClass("text-input-label")}function launchPopup(b,a,e){if(b.indexOf("JFP_TOKEN")>0){b=b}else{if(b.indexOf("?")>0){b=b+"&JFP_TOKEN="+JFP_CSRF_TOKEN}else{b=b+"?JFP_TOKEN="+JFP_CSRF_TOKEN}}var d=a;if(a=="_top"){top.location.href=b;return}var c=document.cookie.split("; ");a=tv(c,"BV_IDS");a=a.substring(38,48);if(d=="sendMsgWindow"){if((chld_win==null||chld_win==""||chld_win.closed)||!(sendMsgChldWin==chld_win)){chld_win=window.open(b,a,e);sendMsgChldWin=chld_win;sendMessageWindow=chld_win}}else{chld_win=window.open(b,a,e);sendMsgChldWin=null}}function tv(a,c){for(var b=0;b<a.length;b++){var d=a[b].split("=");if(d[0]==c){return d[1]}}return""}function initMLC(){var a=$("#cbol-footer-mlc");if(a!=null){if(!isTestDomain()){a.style.color="#ffffff"}if(typeof s!="undefined"&&typeof s.hier1!="undefined"&&s.hier1!=""){a.innerHTML=s.hier1+"/"+s.pageName.replace(/\+/g," ")}if(typeof _server!="undefined"){document.getElementById("cbol-footer-server").innerHTML=displayServerName(_server)}}if(_site=="CBOL"&&top!=self){top.pageload=true}}function displayServerName(h){try{var g="";var f=" ";var e=false;var a=h.length;for(var d=0;d<a;d++){f=h.charAt(d);var b=/^\d+$/.test(f);if(b){g+=f;e=true}else{if(e){g+=".";e=false}}}if(/[\.]+/g.test(g.charAt(g.length-1))){g=g.substring(0,g.length-1)}return g}catch(c){return h}}function isTestDomain(){v=/\.citicorp.com$|\.citicorp.com:[0-9]{4}$|\.citigroup.net$|\.citibankonlineqa.com$|\.nam.nsroot.net$|\localhost$|\localhost:[0-9]{4}$/;return v.test(document.domain)}function getCookie(d){var b=d+"=";var a=document.cookie.split(";");for(var e=0;e<a.length;e++){var f=a[e];while(f.charAt(0)==" "){f=f.substring(1)}if(f.indexOf(b)==0){return f.substring(b.length,f.length)}}return""}function setCookie(a,d,b){var c=escape(d);document.cookie=a+"="+c+";expires="+b+";path=/"}function calLinkCharLength(a){var b=$(a);return b.text().length}function truncateOtherAlert(c,b,f,g){var a=b.length;var e=calLinkCharLength(c);var h=140;var d=a+e;if(b!=""){if(d>h){b=b.substring(0,h-e);$("#"+f).html(b);$("#"+g).removeClass("hidden")}else{$("#"+f).html(b)}}}function truncateBrowserAlert(e,d,b){var j=b.length;var a=calLinkCharLength(e);var f=calLinkCharLength(d);var h=140;var c=j+a;var g=j+f;if(b!=""){if(c>h){if(g>h){b=b.substring(0,h-f);$("#browserAlert").html(b);$("#cmlink_OutdatedBrowserModal").removeClass("hidden")}}else{$("#browserAlert").html(b);$("#cmlink_OutdatedBrowserLnk").removeClass("hidden")}}}function passTmplObj(a){$("#alert-template").tmpl(a).appendTo("#alert-block")}function closeAlertBox(a){$(a).closest(".alertSection").remove()}function showFullMsg(f){var d=alerts.alertData;var e="",c="";for(var b=0;b<d.length;b++){if(d[b].alertType==f){e=d[b].alertMessage;c=d[b].hideText}var a={alertMsg:e,hideLinktext:c}}return a}function hideFullMsg(f){var d=alerts.alertData;var e="",c="";for(var b=0;b<d.length;b++){if(d[b].alertType==f){e=d[b].alertMessage;c=d[b].showText}var a={alertMsg:e,showLinktext:c}}return a}function truncateMsg(c){var a=c.length;var b;if(a<=130){return c}else{b=c.substring(0,127)+"...";return b}}function showAlerts(c){var b=showFullMsg(c);var a=b.alertMsg+'<a class="hideCTA" id='+c+' tabindex="0">'+b.hideLinktext+"</a>";$("#"+c).hide();$("#"+c+"-span").html(a)}function hideAlerts(c){var b=hideFullMsg(c);var a=truncateMsg(b.alertMsg)+'<a class="showCTA" id='+c+' tabindex="0">'+b.showLinktext+"</a>";$("#"+c).hide();$("#"+c+"-span").html(a)}function handleOutageAlert(e){var b,g,a,k,c;for(alert in e.alertData){if(e.alertData[alert].alertType=="outage-alert"){b=e.alertData[alert].startTime;g=e.alertData[alert].endTime}if(e.alertData[alert].alertType=="relevant-alert"){a=e.alertData[alert].startTime;k=e.alertData[alert].endTime}}var l=new Date();var o=(l.getTimezoneOffset()/60);var j=5;if(o>j){c=o-j}else{c=j-o}var d=new Date(new Date(b).getTime()+c*3600*1000);var m=new Date(new Date(g).getTime()+c*3600*1000);var h=new Date(new Date().getTime()+c*3600*1000);var n=new Date(new Date(a).getTime()+c*3600*1000);var f=new Date(new Date(k).getTime()+c*3600*1000);$(".outage-alert-section").hide();$(".relevant-alert-section").hide();if(m>d){if(h>=d){$(".outage-alert-section").show()}if(h>=m){$(".outage-alert-section").hide()}}if(f>n){if(h>=n){$(".relevant-alert-section").show()}if(h>=f){$(".relevant-alert-section").hide()}}}function handleSignonLink(){if(window.innerWidth<992){$("#showLoginBtn").css("display","block")}else{$("#showLoginBtn").css("display","none")}}function adjustHeroHeight(c){var b;if(signonInitialHeight>c){b=signonInitialHeight-c}else{b=c-signonInitialHeight}var a=400+b;if(window.innerWidth>=992){$(".hero--section .hero-background").css("height",a+"px")}}function adjustHeroOnRotation(d,a){if(d>a){var c=d-a;var b=400+c-30;if(window.innerWidth>=992){$(".hero--section .hero-background").css("height",b+"px")}}}$(document).ready(function(){signonInitialHeight=$(".signonContainer").height();$("input[type='checkbox']").prop("checked",false);$("#cookiedList").prop("selectedIndex",0);$("#rememberBlockDesktop,#rememberBlockMobile").on("change","#rememberUid, #rememberUid-mobile",function(b){if($(this).is(":checked")){$("div.ui-tooltip-rmid").removeClass("hidden");$("div.ui-tooltip-rmid").addClass("show");adjustHeroHeight($(".signonContainer").height());signonModalHeight=$("#hpSignonModal .modal-dialog").height()}else{$("div.ui-tooltip-rmid").removeClass("show");$("div.ui-tooltip-rmid").addClass("hidden");adjustHeroHeight($(".signonContainer").height());signonModalHeight=$("#hpSignonModal .modal-dialog").height()}});$("#logInForm").on("focus","#username",function(){$("#usernameLabel").removeClass("text-input-label")});$("#logInForm").on("blur","#username",function(){displayLable("username")});$("#password").focus(function(){$("#passwordLabel").removeClass("text-input-label")});$("#password").blur(function(){displayLable("password")});$("#logInForm").on("focus","#cookiedList",function(){$("#cookiedListLabel").removeClass("text-input-label")});$("#logInForm").on("blur","#cookiedList",function(){displayLable("cookiedList")});if($("#alert-block").length>0){handleSignonLink();$(window).resize(function(){handleSignonLink()})}var a=false;$("#showLoginBtn").on("click",function(){if(a==true){jQuery(".signonDivTrans").addClass("signonContainer");jQuery(".signonContainer").removeClass("signonDivTrans");a=false;$("#showLoginBtn span").removeClass("expanded")}else{jQuery(".signonContainer").addClass("signonDivTrans");jQuery(".signonContainer").removeClass("signonContainer");a=true;$("#showLoginBtn span").addClass("expanded")}});$("#logInForm").on("keydown",function(b){if(b.keyCode==13){b.preventDefault();doSubmit()}});$(".signOnBtn").on("click",function(b){b.preventDefault();$("#hpSignonModal").modal();setTimeout(function(){$("#hpSignonModal #usernameMasked").focus()},500)});if(window.innerWidth<992){$(".signonContainer #logInForm").appendTo("#hpSignonModal .inputGroup");$("#hpSignonModal").on("hidden.bs.modal",function(){clearFieldErrorValidation();$("#username").val("");$("#usernameMasked").val("");$("#password").val("")})}$(window).resize(function(){if(window.innerWidth>=992){$("#hpSignonModal").modal("hide");$("#hpSignonModal #logInForm").appendTo(".signonContainer .sign-on-form");adjustHeroOnRotation(signonModalHeight,signonInitialHeight);signonInitialHeight=375;adjustHeroHeight(423)}else{if(window.innerWidth<992){$(".signonContainer #logInForm").appendTo("#hpSignonModal .inputGroup")}}});$("#hpSignonModal").on("hidden.bs.modal",function(){clearFieldErrorValidation();$("#username").val("");$("#usernameMasked").val("");$("#password").val("");$(":checked").attr("checked",false);$(".ui-tooltip-rmid").addClass("hidden").removeClass("show")});if($("#signOnLoginError").length!=0){signonInitialHeight=375;setTimeout(function(){adjustHeroHeight($(".signonContainer").height())},1200)}});window.onload=function(){if($("#signOnLoginError").text()!=""||$("#signOnLoginError").text()!=undefined){$("span#signOnLoginError").focus();$("span#signOnLoginError").on("keydown",function(b){var a=b.keyCode||b.which;if(a==9){b.preventDefault();if(b.shiftKey){$("ul.pull-right li:nth-child(1) a").focus()}else{$("input#usernameMasked").focus()}}})}};